{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nimport AppLayout from '@/components/layout/AppLayout.vue';\nimport axios from 'axios';\nexport default {\n  components: {\n    AppLayout\n  },\n  data() {\n    return {\n      tableData: [],\n      dialogVisible: false,\n      isEdit: false,\n      choreForm: {\n        id: null,\n        choreName: '',\n        points: 0,\n        dueDate: '',\n        choreStatus: 'PENDING',\n        functionalSpaceType: '',\n        spaceId: null\n      },\n      loadingUsers: false,\n      userCache: null,\n      lastFetchTime: null,\n      resizeObserver: null\n    };\n  },\n  mounted() {\n    this.fetchChores();\n    this.fetchSpaceUsers();\n\n    // Debounced resize observer\n    this.setupResizeObserver();\n  },\n  beforeDestroy() {\n    // Cleanup resize observer\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n    }\n  },\n  methods: {\n    setupResizeObserver() {\n      let timeout;\n      this.resizeObserver = new ResizeObserver(entries => {\n        // Debounce the resize callback\n        clearTimeout(timeout);\n        timeout = setTimeout(() => {\n          entries.forEach(entry => {\n            // Handle resize if needed\n            if (entry.target.classList.contains('el-table__body-wrapper')) {\n              this.$nextTick(() => {\n                const table = this.$el.querySelector('.el-table');\n                if (table && table.__vue__) {\n                  table.__vue__.doLayout();\n                }\n              });\n            }\n          });\n        }, 16); // 60fps throttle\n      });\n\n      // Observe the table wrapper\n      this.$nextTick(() => {\n        const tableWrapper = this.$el.querySelector('.el-table__body-wrapper');\n        if (tableWrapper) {\n          this.resizeObserver.observe(tableWrapper);\n        }\n      });\n    },\n    getStatusType(status) {\n      switch (status) {\n        case 'PENDING':\n          return 'warning';\n        case 'IN_PROGRESS':\n          return 'primary';\n        case 'COMPLETED':\n          return 'success';\n        case 'OVERDUE':\n          return 'danger';\n        default:\n          return 'info';\n      }\n    },\n    editChore(row) {\n      this.isEdit = true;\n      this.choreForm = {\n        ...row\n      };\n      this.dialogVisible = true;\n    },\n    deleteChore(id) {\n      this.$confirm('Are you sure you want to delete this chore?', 'Warning', {\n        confirmButtonText: 'Delete',\n        cancelButtonText: 'Cancel',\n        type: 'warning'\n      }).then(() => {\n        axios.delete(`http://localhost:8080/chores/${id}`).then(() => {\n          this.$message.success('Chore deleted successfully');\n          this.fetchChores();\n        }).catch(error => {\n          console.error('Error deleting chore:', error);\n          this.$message.error('Failed to delete chore');\n        });\n      });\n    },\n    submitChore() {\n      const spaceId = localStorage.getItem('spaceId');\n      if (!spaceId) {\n        this.$message.warning('Please join a space first');\n        return;\n      }\n      const formattedChore = {\n        ...this.choreForm,\n        spaceId: parseInt(spaceId),\n        dueDate: this.choreForm.dueDate ? this.choreForm.dueDate.replace(' ', 'T') + 'Z' : null,\n        functionalSpaceType: this.toEnumFormat(this.choreForm.functionalSpaceType)\n      };\n      const url = this.isEdit ? `http://localhost:8080/chores/${formattedChore.id}` : 'http://localhost:8080/chores';\n      const method = this.isEdit ? 'put' : 'post';\n      axios[method](url, formattedChore).then(() => {\n        this.$message.success(this.isEdit ? 'Chore updated successfully' : 'Chore created successfully');\n        this.dialogVisible = false;\n        this.resetForm();\n        this.fetchChores();\n      }).catch(error => {\n        console.error('Error saving chore:', error);\n        this.$message.error('Failed to save chore');\n      });\n    },\n    resetForm() {\n      this.isEdit = false;\n      this.choreForm = {\n        id: null,\n        choreName: '',\n        points: 0,\n        dueDate: '',\n        choreStatus: 'PENDING',\n        functionalSpaceType: '',\n        spaceId: null\n      };\n    },\n    async fetchChores() {\n      const spaceId = localStorage.getItem('spaceId');\n      if (!spaceId) {\n        this.$message.warning('Please join a space first');\n        this.tableData = [];\n        return;\n      }\n      try {\n        // First verify if user belongs to the space\n        const spaceResponse = await axios.get(`http://localhost:8080/space/${spaceId}`);\n        const userId = localStorage.getItem('userId');\n        if (!spaceResponse.data.users.some(user => user.id === parseInt(userId))) {\n          this.$message.error('You do not have access to this space');\n          this.tableData = [];\n          return;\n        }\n\n        // If user belongs to space, fetch chores with spaceId in URL\n        const response = await axios.get(`http://localhost:8080/chores/space/${spaceId}`);\n        if (response.data && response.data.status === 'success') {\n          this.tableData = response.data.data.map(chore => ({\n            ...chore,\n            showSelect: false,\n            functionalSpaceType: this.formatSpaceType(chore.functionalSpaceType)\n          }));\n        } else {\n          this.$message.error('Failed to fetch chores: Invalid response format');\n        }\n      } catch (error) {\n        console.error('Error fetching chores:', error);\n        this.$message.error('Failed to fetch chores');\n        this.tableData = [];\n      }\n    },\n    async fetchSpaceUsers() {\n      // Don't fetch if we have recent data (cache for 5 minutes)\n      const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes in milliseconds\n      if (this.userCache && this.lastFetchTime && Date.now() - this.lastFetchTime < CACHE_DURATION) {\n        return;\n      }\n      this.loadingUsers = true;\n      const spaceId = localStorage.getItem('spaceId');\n      if (!spaceId) {\n        this.loadingUsers = false;\n        return;\n      }\n      try {\n        const response = await axios.get(`http://localhost:8080/space/${spaceId}`);\n        if (response.data && response.data.users) {\n          this.userCache = response.data.users;\n          this.lastFetchTime = Date.now();\n        }\n      } catch (error) {\n        console.error('Error fetching space users:', error);\n        this.$message.error('Failed to fetch space users');\n      } finally {\n        this.loadingUsers = false;\n      }\n    },\n    assignUser(choreId, userId) {\n      axios.put(`http://localhost:8080/chores/${choreId}/assign/${userId}`).then(response => {\n        if (response.data.status === 'success') {\n          const assignedUser = this.cachedSpaceUsers.find(user => user.id === userId);\n          const chore = this.tableData.find(c => c.id === choreId);\n          if (chore) {\n            chore.assignedUser = assignedUser;\n            chore.choreStatus = 'IN_PROGRESS';\n          }\n          this.$message.success('User assigned successfully');\n        } else {\n          this.$message.error('Failed to assign user');\n        }\n      }).catch(error => {\n        console.error('Error assigning user:', error);\n        this.$message.error('Failed to assign user');\n      });\n    },\n    markAsCompleted(chore) {\n      axios.put(`http://localhost:8080/chores/${chore.id}/complete`).then(response => {\n        if (response.data.status === 'success') {\n          const updatedChore = this.tableData.find(c => c.id === chore.id);\n          if (updatedChore) {\n            updatedChore.choreStatus = 'COMPLETED';\n            // Show celebration notification\n            this.$notify({\n              title: 'Congratulations! ðŸŽ‰',\n              message: `You've earned ${chore.points} points for completing \"${chore.choreName}\"!`,\n              type: 'success',\n              duration: 4000,\n              position: 'top-right'\n            });\n          }\n        } else {\n          this.$message.error('Failed to complete chore');\n        }\n      }).catch(error => {\n        console.error('Error completing chore:', error);\n        this.$message.error('Failed to complete chore');\n      });\n    },\n    async handleChangeClick(row) {\n      await this.fetchSpaceUsers(); // Ensure users are fetched\n      row.showSelect = true; // Show the select dropdown\n    },\n    formatSpaceType(type) {\n      if (!type) return '';\n      return type.toLowerCase().split('_').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');\n    },\n    toEnumFormat(type) {\n      if (!type) return '';\n      return type.toUpperCase().replace(/ /g, '_');\n    }\n  },\n  computed: {\n    assignedUserId: {\n      get() {\n        return this.assignedUser ? this.assignedUser.id : null;\n      },\n      set(value) {\n        this.assignUser(this.id, value);\n      }\n    },\n    sortedTableData() {\n      // First, separate completed and non-completed chores\n      const completedChores = this.tableData.filter(chore => chore.choreStatus === 'COMPLETED');\n      const activeChores = this.tableData.filter(chore => chore.choreStatus !== 'COMPLETED');\n\n      // Sort each group by functional space type\n      const sortBySpaceType = (a, b) => {\n        return a.functionalSpaceType.localeCompare(b.functionalSpaceType);\n      };\n\n      // Sort each group independently\n      const sortedActiveChores = [...activeChores].sort(sortBySpaceType);\n      const sortedCompletedChores = [...completedChores].sort(sortBySpaceType);\n\n      // Return active chores on top, completed chores at bottom\n      return [...sortedActiveChores, ...sortedCompletedChores];\n    },\n    cachedSpaceUsers() {\n      return this.userCache || [];\n    }\n  }\n};","map":{"version":3,"names":["AppLayout","axios","components","data","tableData","dialogVisible","isEdit","choreForm","id","choreName","points","dueDate","choreStatus","functionalSpaceType","spaceId","loadingUsers","userCache","lastFetchTime","resizeObserver","mounted","fetchChores","fetchSpaceUsers","setupResizeObserver","beforeDestroy","disconnect","methods","timeout","ResizeObserver","entries","clearTimeout","setTimeout","forEach","entry","target","classList","contains","$nextTick","table","$el","querySelector","__vue__","doLayout","tableWrapper","observe","getStatusType","status","editChore","row","deleteChore","$confirm","confirmButtonText","cancelButtonText","type","then","delete","$message","success","catch","error","console","submitChore","localStorage","getItem","warning","formattedChore","parseInt","replace","toEnumFormat","url","method","resetForm","spaceResponse","get","userId","users","some","user","response","map","chore","showSelect","formatSpaceType","CACHE_DURATION","Date","now","assignUser","choreId","put","assignedUser","cachedSpaceUsers","find","c","markAsCompleted","updatedChore","$notify","title","message","duration","position","handleChangeClick","toLowerCase","split","word","charAt","toUpperCase","slice","join","computed","assignedUserId","set","value","sortedTableData","completedChores","filter","activeChores","sortBySpaceType","a","b","localeCompare","sortedActiveChores","sort","sortedCompletedChores"],"sources":["src/views/homeharmony/ChoreView.vue"],"sourcesContent":["<template>\r\n    <app-layout>\r\n        <div class=\"chore-container\">\r\n            <!-- Create button -->\r\n            <div class=\"header-actions\">\r\n                <el-button type=\"primary\" @click=\"dialogVisible = true\">Create New Chore</el-button>\r\n            </div>\r\n\r\n            <!-- Chores table -->\r\n            <el-table :data=\"sortedTableData\" border :default-sort=\"{prop: 'functionalSpaceType', order: 'ascending'}\">\r\n                <el-table-column prop=\"functionalSpaceType\" label=\"Functional Space Type\" width=\"180\" sortable></el-table-column>\r\n                <el-table-column prop=\"choreName\" label=\"Chore Name\" width=\"200\"></el-table-column>\r\n                <el-table-column prop=\"points\" label=\"Points\" width=\"100\"></el-table-column>\r\n                <el-table-column prop=\"dueDate\" label=\"Due Date\" width=\"180\"></el-table-column>\r\n                <el-table-column prop=\"choreStatus\" label=\"Status\" width=\"120\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-tag :type=\"getStatusType(scope.row.choreStatus)\">\r\n                            {{ scope.row.choreStatus }}\r\n                        </el-tag>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"Assigned To\" width=\"180\">\r\n                    <template #default=\"scope\">\r\n                        <template v-if=\"scope.row.choreStatus === 'PENDING' || scope.row.showSelect\">\r\n                            <el-select\r\n                                v-model=\"scope.row.assignedUserId\"\r\n                                placeholder=\"Assign user\"\r\n                                :loading=\"loadingUsers\"\r\n                                filterable\r\n                                @change=\"(value) => {\r\n                                    assignUser(scope.row.id, value);\r\n                                    scope.row.showSelect = false;\r\n                                }\">\r\n                                <el-option\r\n                                    v-for=\"user in cachedSpaceUsers\"\r\n                                    :key=\"user.id\"\r\n                                    :label=\"user.username\"\r\n                                    :value=\"user.id\">\r\n                                </el-option>\r\n                            </el-select>\r\n                        </template>\r\n                        <template v-else>\r\n                            <div>\r\n                                {{ scope.row.assignedUser ? scope.row.assignedUser.username : '' }}\r\n                                <el-button \r\n                                    type=\"text\"\r\n                                    size=\"mini\" \r\n                                    @click=\"handleChangeClick(scope.row)\" \r\n                                    v-if=\"scope.row.choreStatus === 'IN_PROGRESS'\">\r\n                                    Change\r\n                                </el-button>\r\n                            </div>\r\n                        </template>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"Complete\" width=\"120\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button \r\n                            :type=\"scope.row.choreStatus === 'COMPLETED' ? 'success' : 'primary'\"\r\n                            size=\"mini\"\r\n                            :disabled=\"scope.row.choreStatus === 'COMPLETED'\"\r\n                            @click=\"markAsCompleted(scope.row)\">\r\n                            {{ scope.row.choreStatus === 'COMPLETED' ? 'Completed' : 'Mark Complete' }}\r\n                        </el-button>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"Options\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button type=\"primary\" size=\"mini\" @click=\"editChore(scope.row)\">Edit</el-button>\r\n                        <el-button type=\"danger\" size=\"mini\" @click=\"deleteChore(scope.row.id)\">Delete</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n            <!-- Create/Edit Dialog -->\r\n            <el-dialog :title=\"isEdit ? 'Edit Chore' : 'Create New Chore'\" :visible.sync=\"dialogVisible\" width=\"30%\">\r\n                <el-form :model=\"choreForm\" label-width=\"120px\">\r\n                    <el-form-item label=\"Chore Name\">\r\n                        <el-input v-model=\"choreForm.choreName\" placeholder=\"Enter chore name\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"Points\">\r\n                        <el-input-number v-model=\"choreForm.points\" :min=\"0\"></el-input-number>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"Due Date\">\r\n                        <el-date-picker\r\n                            v-model=\"choreForm.dueDate\"\r\n                            type=\"datetime\"\r\n                            placeholder=\"Select due date\"\r\n                            value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n                            :picker-options=\"{\r\n                                firstDayOfWeek: 1\r\n                            }\"\r\n                            :lang=\"'en'\"\r\n                        >\r\n                        </el-date-picker>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"Functional Space\">\r\n                        <el-select v-model=\"choreForm.functionalSpaceType\" placeholder=\"Select functional space\">\r\n                            <el-option label=\"Kitchen\" value=\"KITCHEN\"></el-option>\r\n                            <el-option label=\"Bathroom\" value=\"BATHROOM\"></el-option>\r\n                            <el-option label=\"Living Room\" value=\"LIVING_ROOM\"></el-option>\r\n                            <el-option label=\"Bedroom\" value=\"BEDROOM\"></el-option>\r\n                            <el-option label=\"Dining Room\" value=\"DINING_ROOM\"></el-option>\r\n                            <el-option label=\"Home Office\" value=\"HOME_OFFICE\"></el-option>\r\n                            <el-option label=\"Garage\" value=\"GARAGE\"></el-option>\r\n                            <el-option label=\"Balcony\" value=\"BALCONY\"></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                </el-form>\r\n                <span slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"dialogVisible = false\">Cancel</el-button>\r\n                    <el-button type=\"primary\" @click=\"submitChore\">{{ isEdit ? 'Update' : 'Create' }}</el-button>\r\n                </span>\r\n            </el-dialog>\r\n        </div>\r\n    </app-layout>\r\n</template>\r\n\r\n<script>\r\nimport AppLayout from '@/components/layout/AppLayout.vue'\r\nimport axios from 'axios'\r\n\r\nexport default {\r\n    components: {\r\n        AppLayout\r\n    },\r\n    data() {\r\n        return {\r\n            tableData: [],\r\n            dialogVisible: false,\r\n            isEdit: false,\r\n            choreForm: {\r\n                id: null,\r\n                choreName: '',\r\n                points: 0,\r\n                dueDate: '',\r\n                choreStatus: 'PENDING',\r\n                functionalSpaceType: '',\r\n                spaceId: null\r\n            },\r\n            loadingUsers: false,\r\n            userCache: null,\r\n            lastFetchTime: null,\r\n            resizeObserver: null\r\n        }\r\n    },\r\n    mounted() {\r\n        this.fetchChores()\r\n        this.fetchSpaceUsers()\r\n        \r\n        // Debounced resize observer\r\n        this.setupResizeObserver()\r\n    },\r\n    beforeDestroy() {\r\n        // Cleanup resize observer\r\n        if (this.resizeObserver) {\r\n            this.resizeObserver.disconnect()\r\n        }\r\n    },\r\n    methods: {\r\n        setupResizeObserver() {\r\n            let timeout\r\n            this.resizeObserver = new ResizeObserver((entries) => {\r\n                // Debounce the resize callback\r\n                clearTimeout(timeout)\r\n                timeout = setTimeout(() => {\r\n                    entries.forEach(entry => {\r\n                        // Handle resize if needed\r\n                        if (entry.target.classList.contains('el-table__body-wrapper')) {\r\n                            this.$nextTick(() => {\r\n                                const table = this.$el.querySelector('.el-table')\r\n                                if (table && table.__vue__) {\r\n                                    table.__vue__.doLayout()\r\n                                }\r\n                            })\r\n                        }\r\n                    })\r\n                }, 16) // 60fps throttle\r\n            })\r\n\r\n            // Observe the table wrapper\r\n            this.$nextTick(() => {\r\n                const tableWrapper = this.$el.querySelector('.el-table__body-wrapper')\r\n                if (tableWrapper) {\r\n                    this.resizeObserver.observe(tableWrapper)\r\n                }\r\n            })\r\n        },\r\n        getStatusType(status) {\r\n            switch (status) {\r\n                case 'PENDING': return 'warning'\r\n                case 'IN_PROGRESS': return 'primary'\r\n                case 'COMPLETED': return 'success'\r\n                case 'OVERDUE': return 'danger'\r\n                default: return 'info'\r\n            }\r\n        },\r\n        editChore(row) {\r\n            this.isEdit = true\r\n            this.choreForm = { ...row }\r\n            this.dialogVisible = true\r\n        },\r\n        deleteChore(id) {\r\n            this.$confirm('Are you sure you want to delete this chore?', 'Warning', {\r\n                confirmButtonText: 'Delete',\r\n                cancelButtonText: 'Cancel',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                axios.delete(`http://localhost:8080/chores/${id}`)\r\n                    .then(() => {\r\n                        this.$message.success('Chore deleted successfully')\r\n                        this.fetchChores()\r\n                    })\r\n                    .catch(error => {\r\n                        console.error('Error deleting chore:', error)\r\n                        this.$message.error('Failed to delete chore')\r\n                    })\r\n            })\r\n        },\r\n        submitChore() {\r\n            const spaceId = localStorage.getItem('spaceId');\r\n            if (!spaceId) {\r\n                this.$message.warning('Please join a space first');\r\n                return;\r\n            }\r\n\r\n            const formattedChore = {\r\n                ...this.choreForm,\r\n                spaceId: parseInt(spaceId),\r\n                dueDate: this.choreForm.dueDate ? this.choreForm.dueDate.replace(' ', 'T') + 'Z' : null,\r\n                functionalSpaceType: this.toEnumFormat(this.choreForm.functionalSpaceType)\r\n            };\r\n\r\n            const url = this.isEdit \r\n                ? `http://localhost:8080/chores/${formattedChore.id}`\r\n                : 'http://localhost:8080/chores';\r\n            const method = this.isEdit ? 'put' : 'post';\r\n\r\n            axios[method](url, formattedChore)\r\n                .then(() => {\r\n                    this.$message.success(this.isEdit ? 'Chore updated successfully' : 'Chore created successfully');\r\n                    this.dialogVisible = false;\r\n                    this.resetForm();\r\n                    this.fetchChores();\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error saving chore:', error);\r\n                    this.$message.error('Failed to save chore');\r\n                });\r\n        },\r\n        resetForm() {\r\n            this.isEdit = false;\r\n            this.choreForm = {\r\n                id: null,\r\n                choreName: '',\r\n                points: 0,\r\n                dueDate: '',\r\n                choreStatus: 'PENDING',\r\n                functionalSpaceType: '',\r\n                spaceId: null\r\n            };\r\n        },\r\n        async fetchChores() {\r\n            const spaceId = localStorage.getItem('spaceId');\r\n            if (!spaceId) {\r\n                this.$message.warning('Please join a space first');\r\n                this.tableData = [];\r\n                return;\r\n            }\r\n\r\n            try {\r\n                // First verify if user belongs to the space\r\n                const spaceResponse = await axios.get(`http://localhost:8080/space/${spaceId}`);\r\n                const userId = localStorage.getItem('userId');\r\n                \r\n                if (!spaceResponse.data.users.some(user => user.id === parseInt(userId))) {\r\n                    this.$message.error('You do not have access to this space');\r\n                    this.tableData = [];\r\n                    return;\r\n                }\r\n\r\n                // If user belongs to space, fetch chores with spaceId in URL\r\n                const response = await axios.get(`http://localhost:8080/chores/space/${spaceId}`);\r\n                if (response.data && response.data.status === 'success') {\r\n                    this.tableData = response.data.data.map(chore => ({\r\n                        ...chore,\r\n                        showSelect: false,\r\n                        functionalSpaceType: this.formatSpaceType(chore.functionalSpaceType)\r\n                    }));\r\n                } else {\r\n                    this.$message.error('Failed to fetch chores: Invalid response format');\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching chores:', error);\r\n                this.$message.error('Failed to fetch chores');\r\n                this.tableData = [];\r\n            }\r\n        },\r\n        async fetchSpaceUsers() {\r\n            // Don't fetch if we have recent data (cache for 5 minutes)\r\n            const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes in milliseconds\r\n            if (this.userCache && this.lastFetchTime && \r\n                (Date.now() - this.lastFetchTime < CACHE_DURATION)) {\r\n                return;\r\n            }\r\n\r\n            this.loadingUsers = true;\r\n            const spaceId = localStorage.getItem('spaceId');\r\n            if (!spaceId) {\r\n                this.loadingUsers = false;\r\n                return;\r\n            }\r\n            \r\n            try {\r\n                const response = await axios.get(`http://localhost:8080/space/${spaceId}`);\r\n                if (response.data && response.data.users) {\r\n                    this.userCache = response.data.users;\r\n                    this.lastFetchTime = Date.now();\r\n                }\r\n            } catch (error) {\r\n                console.error('Error fetching space users:', error);\r\n                this.$message.error('Failed to fetch space users');\r\n            } finally {\r\n                this.loadingUsers = false;\r\n            }\r\n        },\r\n        assignUser(choreId, userId) {\r\n            axios.put(`http://localhost:8080/chores/${choreId}/assign/${userId}`)\r\n                .then(response => {\r\n                    if (response.data.status === 'success') {\r\n                        const assignedUser = this.cachedSpaceUsers.find(user => user.id === userId);\r\n                        const chore = this.tableData.find(c => c.id === choreId);\r\n                        if (chore) {\r\n                            chore.assignedUser = assignedUser;\r\n                            chore.choreStatus = 'IN_PROGRESS';\r\n                        }\r\n                        this.$message.success('User assigned successfully');\r\n                    } else {\r\n                        this.$message.error('Failed to assign user');\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error assigning user:', error);\r\n                    this.$message.error('Failed to assign user');\r\n                });\r\n        },\r\n        markAsCompleted(chore) {\r\n            axios.put(`http://localhost:8080/chores/${chore.id}/complete`)\r\n                .then(response => {\r\n                    if (response.data.status === 'success') {\r\n                        const updatedChore = this.tableData.find(c => c.id === chore.id);\r\n                        if (updatedChore) {\r\n                            updatedChore.choreStatus = 'COMPLETED';\r\n                            // Show celebration notification\r\n                            this.$notify({\r\n                                title: 'Congratulations! ðŸŽ‰',\r\n                                message: `You've earned ${chore.points} points for completing \"${chore.choreName}\"!`,\r\n                                type: 'success',\r\n                                duration: 4000,\r\n                                position: 'top-right'\r\n                            });\r\n                        }\r\n                    } else {\r\n                        this.$message.error('Failed to complete chore');\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error completing chore:', error);\r\n                    this.$message.error('Failed to complete chore');\r\n                });\r\n        },\r\n        async handleChangeClick(row) {\r\n            await this.fetchSpaceUsers();  // Ensure users are fetched\r\n            row.showSelect = true;  // Show the select dropdown\r\n        },\r\n        formatSpaceType(type) {\r\n            if (!type) return '';\r\n            return type.toLowerCase()\r\n                .split('_')\r\n                .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n                .join(' ');\r\n        },\r\n        toEnumFormat(type) {\r\n            if (!type) return '';\r\n            return type.toUpperCase().replace(/ /g, '_');\r\n        }\r\n    },\r\n    computed: {\r\n        assignedUserId: {\r\n            get() {\r\n                return this.assignedUser ? this.assignedUser.id : null;\r\n            },\r\n            set(value) {\r\n                this.assignUser(this.id, value);\r\n            }\r\n        },\r\n        sortedTableData() {\r\n            // First, separate completed and non-completed chores\r\n            const completedChores = this.tableData.filter(chore => chore.choreStatus === 'COMPLETED');\r\n            const activeChores = this.tableData.filter(chore => chore.choreStatus !== 'COMPLETED');\r\n\r\n            // Sort each group by functional space type\r\n            const sortBySpaceType = (a, b) => {\r\n                return a.functionalSpaceType.localeCompare(b.functionalSpaceType);\r\n            };\r\n\r\n            // Sort each group independently\r\n            const sortedActiveChores = [...activeChores].sort(sortBySpaceType);\r\n            const sortedCompletedChores = [...completedChores].sort(sortBySpaceType);\r\n\r\n            // Return active chores on top, completed chores at bottom\r\n            return [...sortedActiveChores, ...sortedCompletedChores];\r\n        },\r\n        cachedSpaceUsers() {\r\n            return this.userCache || [];\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n.chore-container {\r\n    padding: 20px;\r\n    position: relative;\r\n    max-width: 100%;\r\n}\r\n\r\n:deep(.el-table) {\r\n    max-width: 100%;\r\n}\r\n\r\n:deep(.el-table__body-wrapper) {\r\n    overflow-x: auto !important;\r\n}\r\n\r\n:deep(.el-table__header-wrapper) {\r\n    overflow-x: hidden !important;\r\n}\r\n\r\n.header-actions {\r\n    margin-bottom: 20px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.dialog-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: 10px;\r\n}\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}